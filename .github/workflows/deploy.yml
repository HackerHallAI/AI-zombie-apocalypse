name: Deploy to GitHub Pages

on:
  push:
    branches: [ main ]
  workflow_dispatch:

jobs:
  build-and-deploy:
    runs-on: ubuntu-latest
    steps:
      - name: Checkout
        uses: actions/checkout@v3

      - name: Create Supabase Config
        run: |
          cat > zombie-js/supabase-config.js << 'EOL'
          // Supabase configuration
          window.supabaseConfig = {
            supabaseUrl: "${{ secrets.SUPABASE_URL }}",
            supabaseKey: "${{ secrets.SUPABASE_KEY }}"
          };
          
          // Initialize Supabase client
          window.initSupabase = function() {
            try {
              window.supabaseClient = supabase.createClient(
                window.supabaseConfig.supabaseUrl,
                window.supabaseConfig.supabaseKey
              );
              console.log("Supabase client initialized");
              return true;
            } catch (error) {
              console.error("Failed to initialize Supabase client:", error);
              window.supabaseClient = null;
              return false;
            }
          };
          EOL
